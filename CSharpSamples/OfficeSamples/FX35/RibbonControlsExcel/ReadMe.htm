<html><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" /><META NAME="save" CONTENT="history" /><title xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Пример создания элементов управления на ленте</title><META NAME="Description" CONTENT="Данный пример работает только в Microsoft Office Excel 2007."></META><META NAME="MS.LOCALE" CONTENT="en-us" /><style>
body
{font-family:Verdana;font-size:medium;}
div#mainSection, div#header
{font-size:70%;width: 100%;}
div#mainBody
{font-size:90%;}
div#mainSection div table
{font-size: 100%;text-align: left;}
span#nsrTitle
{color:#003399;font-size:90%;font-weight:600;}
div#header
{background-color:#D4DFFF;}
.heading
{font-size:120%;color:#003399;}
.subHeading
{font-size:100%;margin-bottom:4;}
li
{margin-top:-2;margin-bottom:3;}
p
{margin-top:10;margin-bottom:5;}
div.tableSection p
{margin-top:1;margin-bottom:4;}	
div#mainSection table th
{background-color:#EFEFF7;color:#000066;text-align:left;}
div#mainSection table td
{background-color:#F7F7FF;}
div#mainSection table
{margin-top:5px;margin-bottom: px;}
.style1{color: Green;}
			</style></head><body><div id="header"><table width="100%" id="topTable"></table></div><div id="mainSection"><div id="mainBody"><p><span class="style1">&#39; © Корпорация Майкрософт (Microsoft Corp.). Все права защищены. </span> <br class="style1" /> <span class="style1">&#39; Данный код выпущен на условиях </span> <br class="style1" /> <span class="style1">&#39; открытой лицензии Майкрософт (MS-PL, <a href="http://opensource.org/licenses/ms-pl.html"> http://opensource.org/licenses/ms-pl.html</a>.)</span></p><br /><div class="introduction"><div class="alert"><table width="100%" cellspacing="0" cellpadding="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><tr><th align="left"><b>Примечание.</b></th></tr><tr><td><p>Данный пример работает только в Microsoft Office Excel 2007 и последующих версиях.</p></td></tr></table></div><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">В этом примере показано, как создать настраиваемую вкладку на ленте листа Microsoft Office Excel. На этой настраиваемой ленте содержится большинство элементов управления, доступных в группе <span class="ui">Элементы управления ленты Office</span> на <span class="ui">панели элементов</span> Visual Studio. Дополнительные сведения об использовании этих элементов управления см. в разделе «Конструктор лент».</p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><tr><th align="left"><b>Примечание по безопасности.</b></th></tr><tr><td><p>Этот пример кода приведен для иллюстрации концепции, в нем приведен код, который относится только к данной концепции. Пример может не отвечать требованиям безопасности для определенной среды, и его не следует использовать в точности в том виде, в котором он приведен. Чтобы сделать проект более безопасным и надежным, рекомендуется добавить в него код обеспечения безопасности и код обработки ошибок. Корпорация Майкрософт предоставляет этот пример кода на условиях «КАК ЕСТЬ», без каких-либо гарантий.</p></td></tr></table></div><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Сведения об установке проекта примера на компьютере см. в разделе «Инструкции: установка и использование файлов примеров, включенных в справку».</p></div><h3 class="procedureSubHeading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Запуск примера</h3><div class="subSection"><ol xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><li><p>Нажмите клавишу F5.</p></li><li><p>Откроется лист Excel. На этом листе на ленте содержится настраиваемая вкладка <span class="ui">Пример элемента управления ленты</span>. </p><p>Других вкладок на ленте нет, поскольку свойство StartFromScratch этой ленты имеет значение <span class="keyword">true</span>. </p></li></ol></div><h1 class="heading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><span onclick="ExpandCollapse(requirementsTitleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(requirementsTitleToggle, event)" tabindex="0">Требования</span></h1><div id="requirementsTitleSection" class="section"><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Для выполнения этого примера требуются следующие приложения:</p><ul xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><li><p>
            Набор средств Visual Studio Tools для Office.</p></li><li><p>Microsoft Office Excel 2007.</p></li></ul></div><h1 class="heading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><span onclick="ExpandCollapse(demonstratesToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(demonstratesToggle, event)" tabindex="0">Демонстрации</span></h1><div id="demonstratesSection" class="section"><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">В этом примере показано выполнение следующих задач:</p><ul xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><li><p>Настройка вкладки при помощи шаблона элемента <span class="ui">Лента (визуальный конструктор)</span>.</p></li><li><p>Скрытие все встроенных вкладок и большинства команд меню Office и вывод настроек, определенных только для данного элемента ленты. </p></li><li><p>Добавление групп и элементов управления в конструктор лент.</p></li><li><p>Обработка событий элементов управления на ленте.</p></li><li><p>Изменение свойств элементов управления во время выполнения.</p></li><li><p>Динамическое добавление элементов управления в меню во время выполнения.</p></li><li><p>Динамическое добавление элементов в коллекцию во время выполнения.</p></li><li><p>Скрытие и отображение области действий при помощи кнопок ленты.</p></li></ul><h1 class="heading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><span onclick="ExpandCollapse(sectionToggle0)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle0, event)" tabindex="0">Группа «Работа с листами»</span></h1><div id="sectionSection0" class="section"><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">В следующей таблице описаны элементы управления, содержащиеся в группе <span class="ui">Работа с листами</span> настраиваемой ленты:</p><div class="caption"></div><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><tr><th><p>Элемент управления</p></th><th><p>Описание</p></th><th><p>Действие или результат</p></th></tr><tr><td><p><span class="ui">Показать панель действий.</span></p></td><td><p>Выключатель, отображаемый нажатым или отпущенным.</p></td><td><p>Нажмите <span class="ui">Показать панель действий</span>. </p><p>Рядом с листом появляется панель действий. </p><p>Нажмите <span class="ui">Показать панель действий</span> дважды, чтобы скрыть панель действий.</p></td></tr><tr><td><p>Лицевая сторона кнопок.</p></td><td><p>Три кнопки содержатся в группе кнопок. Эти кнопки добавлены в группу кнопок, потому что они связаны друг с другом. Кнопки в группе кнопок выглядят блестящими.</p></td><td><p>Нажмите на лицевую сторону кнопки.</p><p>В ячейке A1 появится соответствующее изображение.</p></td></tr><tr><td><p><span class="ui">Выравнивание</span></p></td><td><p>Разворачивающаяся кнопка. Разворачивающаяся кнопка — это кнопка с вложенным меню. Меню разворачивающейся кнопки <span class="ui">Выравнивание</span> содержит три кнопки. Свойству OfficeImageId кнопки <span class="ui">Выравнивание</span> присваивается в качестве значения идентификатор встроенного элемента управления выравниванием Office.</p></td><td><p>Нажмите <span class="ui">Выравнивание по правому краю</span>, <span class="ui">Выравнивание по левому краю</span>, или <span class="ui">Выравнивание по центру</span> в разворачивающейся кнопке меню <span class="ui">Выравнивание</span>.</p><p>Текст, отображенный в ячейке A3, соответственно выравнивается по правому краю, по левому краю или по центру.</p></td></tr><tr><td><p><span class="ui">Цвет</span></p></td><td><p>Коллекция, предоставляющая пользователю возможность выбора из массива цветных сфер. </p></td><td><p>Нажмите <span class="ui">Цвет</span> и затем выберите цвет из коллекции.</p><p>Сфера выбранного цвета появится в ячейке A6.</p></td></tr><tr><td><p><span class="ui">Формат диаграммы</span></p></td><td><p>Элемент управления «Раскрывающийся список», который содержит список форматов диаграмм. В отличие от поля со списком, в раскрывающемся списке нельзя вводить выбираемый пункт. </p></td><td><p>Нажмите <span class="ui">Формат диаграммы</span> и затем выберите формат из списка.</p><p>Формат диаграммы, которая появится на листе, изменяется в соответствии с выбранным форматом.</p></td></tr><tr><td><p><span class="ui">Поиск последних использованных элементов</span></p></td><td><p>Поле со списком. Можно либо ввести значение, либо выбрать значение из списка.</p></td><td><p>Щелкните в поле со списком <span class="ui">Поиск последних использованных элементов</span> и затем выберите текст из списка.</p><p>—либо—</p><p>В поле со списком <span class="ui">Поиск последних использованных элементов</span> введите любой текст и нажмите клавишу ВВОД.</p><p>Отображается окно сообщения, в котором указывается расположение текста на листе.</p></td></tr></table></div></div><h1 class="heading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><span onclick="ExpandCollapse(sectionToggle1)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle1, event)" tabindex="0">Группа «Построение динамического меню»</span></h1><div id="sectionSection1" class="section"><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">В следующей таблице описаны элементы управления, содержащиеся в группе <span class="ui">Построение динамического меню</span> настраиваемой ленты.</p><div class="caption"></div><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><tr><th><p>Элемент управления</p></th><th><p>Описание</p></th><th><p>Действие или результат</p></th></tr><tr><td><p><span class="ui">Динамическое меню</span></p></td><td><p>Меню. Меню — это раскрывающийся список, который может содержать другие элементы управления ленты.</p><p>Свойству Dynamic этого меню присваивается значение <span class="keyword">true</span>. Это позволяет динамически обновлять меню во время выполнения.</p></td><td><p>Нажмите <span class="ui">Динамическое меню</span>, чтобы показать меню элементов управления.</p></td></tr><tr><td><p><span class="ui">CheckBox</span>, <span class="ui">DropDown</span>, <span class="ui">SubMenu</span>, <span class="ui">Gallery</span>, <span class="ui">Button</span>, <span class="ui">Separator</span></p></td><td><p>Набор флажков. Можно установить или снять любой флажок, чтобы включить или отключить соответствующий параметр.</p><p>Каждый флажок представляет элемент управления ленты, который может быть добавлен в <span class="ui">Динамическое меню</span>.</p></td><td><p>Нажмите на флажок, чтобы добавить управляющий элемент ленты в <span class="ui">Динамическое меню</span>.</p></td></tr></table></div></div></div></div>
    </div>
</body></html>
