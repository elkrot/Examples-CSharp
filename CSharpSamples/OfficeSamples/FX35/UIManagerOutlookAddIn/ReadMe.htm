<html><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" /><META NAME="save" CONTENT="history" /><title xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Пример диспетчера пользовательского интерфейса</title><META NAME="Description" CONTENT="Данный пример работает только в Microsoft Office Outlook 2007."></META><META NAME="MS.LOCALE" CONTENT="en-us" /><style>
body
{font-family:Verdana;font-size:medium;}
div#mainSection, div#header
{font-size:70%;width: 100%;}
div#mainBody
{font-size:90%;}
div#mainSection div table
{font-size: 100%;text-align: left;}
span#nsrTitle
{color:#003399;font-size:90%;font-weight:600;}
div#header
{background-color:#D4DFFF;}
.heading
{font-size:120%;color:#003399;}
.subHeading
{font-size:100%;margin-bottom:4;}
li
{margin-top:-2;margin-bottom:3;}
p
{margin-top:10;margin-bottom:5;}
div.tableSection p
{margin-top:1;margin-bottom:4;}	
div#mainSection table th
{background-color:#EFEFF7;color:#000066;text-align:left;}
div#mainSection table td
{background-color:#F7F7FF;}
div#mainSection table
{margin-top:5px;margin-bottom: px;}
.style1{color: Green;}
			</style></head><body><div id="header"><table width="100%" id="topTable"></table></div><div id="mainSection"><div id="mainBody"><p><span class="style1">&#39; © Корпорация Майкрософт (Microsoft Corp.). Все права защищены. </span> <br class="style1" /> <span class="style1">&#39; Данный код выпущен на условиях </span> <br class="style1" /> <span class="style1">&#39; открытой лицензии Майкрософт (MS-PL, <a href="http://opensource.org/licenses/ms-pl.html"> http://opensource.org/licenses/ms-pl.html</a>.)</span></p><br /><div class="introduction"><div class="alert"><table width="100%" cellspacing="0" cellpadding="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><tr><th align="left"><b>Примечание.</b></th></tr><tr><td><p>Данный пример работает только в Microsoft Office Outlook 2007 и последующих версиях.</p></td></tr></table></div><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">В этом примере описывается порядок настройки пользовательского интерфейса для Microsoft Office Outlook 2007 посредством реализации интерфейсов расширяемости в надстройке. Этот пример использует интерфейсы расширяемости для создания настройки ленты, настраиваемой области задач и настраиваемой области формы.</p><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">В примере также демонстрируется координация настраиваемых элементов интерфейса для использования в определенном окне инспектора. Код этого примера обеспечивает правильное взаимодействие настройки ленты, настраиваемой области задач и области формы в окне инспектора. Они должны взаимодействовать изолированно от других экземпляров этих настраиваемых элементов интерфейса, которые могут быть открыты в других окнах инспектора.</p><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Например, пользователь может открыть несколько окон инспектора, каждое из которых имеет настраиваемую ленту, область задач и область формы. Взаимодействие пользователя с одним из этих элементов (например, нажатие кнопки на ленте) может вызвать изменение в другом элементе (например, скрытие области задач). Код должен гарантировать, что взаимодействие затрагивает только элементы в одном окне инспектора, но не другие экземпляры тех же элементов в других окнах инспектора.</p><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Этот пример использует набор классов, создающих программу-оболочку для окна инспектора и объектов настраиваемых областей задач, что позволяет отображать новую область задач для каждой открытой пользователем задачи и каждого сообщения электронной почты. В примере также создаются настраиваемые кнопки ленты, которые можно использовать для скрытия или отображения области задач в каждой задаче или сообщении электронной почты, а в каждой задаче отображается настраиваемая область формы. Дополнительные сведения о структуре этого примера см. в разделе «Компоненты примера диспетчера пользовательского интерфейса».</p><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Сведения об установке примера проекта на компьютере см. в разделе «Инструкции: установка и использование файлов примеров, включенных в справку».</p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><tr><th align="left"><b>Примечание.</b></th></tr><tr><td><p>Хотя в этом примере для создания настройки ленты, настраиваемой области задач и области формы используются интерфейсы расширяемости, набор средств Visual Studio Tools для Office предоставляет классы и конструкторы, которые также можно использовать для выполнения этих задач. Использование таких классов и конструкторов позволяет упростить работу с этими функциями. Дополнительные сведения см. в разделах «Конструктор лент», «Общие сведения о настраиваемых областях задач» и «Создание областей форм Outlook».</p></td></tr></table></div><div class="alert"><table width="100%" cellspacing="0" cellpadding="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><tr><th align="left"><b>Примечание по безопасности.</b></th></tr><tr><td><p>Этот пример кода приведен для иллюстрации концепции, в нем приведен код, который относится только к данной концепции. Пример может не отвечать требованиям безопасности для определенной среды, и его не следует использовать в точности в том виде, в котором он приведен. Чтобы сделать проект более безопасным и надежным, рекомендуется добавить в него код обеспечения безопасности и код обработки ошибок. Корпорация Майкрософт предоставляет этот пример кода на условиях «КАК ЕСТЬ», без каких-либо гарантий.</p></td></tr></table></div></div><h3 class="procedureSubHeading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Запуск примера</h3><div class="subSection"><ol xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><li><p>Нажмите клавишу F5.</p></li><li><p>Создайте новую задачу в Outlook.</p></li><li><p>На ленте задачи выберите вкладку <span class="ui">Надстройки</span>. </p></li><li><p>В группе <span class="ui">UI Manager</span> нажмите кнопку <span class="ui">TaskPane</span>.</p><p>Убедитесь, что рядом с окном задачи отображается область задач <span class="ui">SimpleControl</span>.</p></li><li><p>В группе <span class="ui">Show</span> нажмите кнопку <span class="ui">UIM</span>.</p><p>Убедитесь, что настраиваемая область формы отображается в области чтения открытой задачи. Область формы отображает список сортов кофе и текстовое поле, содержащее число размещенных заказов кофе.</p></li><li><p>Выберите один или несколько сортов кофе в области формы.</p><p>Убедитесь, что все выбранные сорта добавлены в область задач <span class="ui">SimpleControl</span>.</p></li><li><p>В группе ленты <span class="ui">Службы надстройки</span> нажмите кнопку <span class="ui">Отправить</span>.</p><p>Убедитесь, что новое сообщение электронной почты отправлено получателю <span class="input">proverka@example.com</span>, а в самом сообщении указаны все сорта кофе, выбранные в области формы. </p><p>Так как сообщение электронной почты представляет собой заказ кофе, то количество заказов в области формы будет увеличено.</p></li></ol></div><h1 class="heading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><span onclick="ExpandCollapse(requirementsTitleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(requirementsTitleToggle, event)" tabindex="0">Требования</span></h1><div id="requirementsTitleSection" class="section"><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Для выполнения этого примера требуются следующие приложения:</p><ul xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><li><p>
            Набор средств Visual Studio Tools for Office.</p></li><li><p>Microsoft Office Outlook 2007.</p></li></ul></div><h1 class="heading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><span onclick="ExpandCollapse(demonstratesToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(demonstratesToggle, event)" tabindex="0">Демонстрации</span></h1><div id="demonstratesSection" class="section"><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">В этом примере показано выполнение следующих задач:</p><ul xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><li><p>Создание настройки ленты путем реализации интерфейса <b>Microsoft.Office.Core.IRibbonExtensibility</b> в надстройке.</p></li><li><p>Создание настраиваемой области задач путем реализации интерфейса <b>Microsoft.Office.Core.ICustomTaskPaneConsumer</b> в надстройке.</p></li><li><p>Создание настраиваемой области формы путем реализации интерфейса <b>Microsoft.Office.Interop.Outlook.FormRegionStartup</b> в надстройке.</p></li><li><p>Синхронизация настройки ленты, настраиваемой области задач и области формы и управление ими в различных сообщениях электронной почты и задачах Outlook.</p></li></ul></div><h1 class="heading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><span onclick="ExpandCollapse(sectionToggle0)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle0, event)" tabindex="0">Компоненты примера диспетчера пользовательского интерфейса</span></h1><div id="sectionSection0" class="section"><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Решение, представленное в примере, включает в себя два проекта:</p><ul xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><li><p>Microsoft.Samples.Vsto.UiManager является проектом надстройки для Outlook. Этот проект содержит реализации интерфейсов расширяемости, а также другие классы и файлы, которые поддерживают эти реализации. </p></li><li><p>Microsoft.Samples.Vsto.AddinUtilities является библиотекой классов, включающей в себя классы управления пользовательским интерфейсом и интерфейсы, используемые проектом надстройки Outlook. </p></li></ul><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Эти проекты предоставляют компоненты, реализующие настраиваемую область задач, настройку ленты и область формы, а также компоненты, облегчающие синхронизацию и управление этими функциями.</p><h3 class="subHeading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Компоненты управления пользовательским интерфейсом</h3><div class="subsection"><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">В следующей таблице приводится описание файлов проекта, которые предоставляют код для настройки ленты:</p><div class="caption"></div><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><tr><th><p>Файл</p></th><th><p>Описание</p></th></tr><tr><td><p>ThisAddIn.cs/vb</p></td><td><p>Содержит переопределение метода RequestService и код, создающий новую настраиваемую область задач для каждого окна инспектора. Дополнительные сведения об этом методе см. в разделе «Настройка функций пользовательского интерфейса с помощью интерфейсов расширяемости».</p></td></tr><tr><td><p>UserInterfaceContainer.cs/vb</p></td><td><p>Определяет класс <span class="code">UserInterfaceContainer</span>. Каждый объект <span class="code">UserInterfaceContainer</span> управляет областью формы, областью задач и настройкой ленты для каждого сообщения электронной почты или задачи.</p></td></tr><tr><td><p>UserInterfaceElements.cs/vb</p></td><td><p>Определяет класс <span class="code">UserInterfaceElements</span>. Он поддерживает коллекцию объектов <span class="code">UserInterfaceContainter</span>, используемых надстройкой. </p></td></tr><tr><td><p>IFormRegionControls.cs/vb</p><p>IRibbonConnector.cs/vb</p></td><td><p>Определяет интерфейсы, которые используются некоторыми классами в проектах Microsoft.Samples.Vsto.UiManager и Microsoft.Samples.Vsto.AddinUtilities для взаимодействия друг с другом.</p></td></tr></table></div></div><h3 class="subHeading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Компоненты настраиваемой области задач</h3><div class="subsection"><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">В следующей таблице приводится описание файлов проекта, которые предоставляют код для настраиваемой области задач:</p><div class="caption"></div><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><tr><th><p>Файл</p></th><th><p>Описание</p></th></tr><tr><td><p>TaskPaneConnector.cs/vb</p></td><td><p>Определяет класс <span class="code">TaskPaneConnector</span>. Этот класс реализует интерфейс <b> Microsoft.Office.Core.ICustomTaskPaneConsumer</b>.</p></td></tr><tr><td><p>SimpleControl.cs/vb</p></td><td><p>Определяет объект UserControl, который предоставляет пользовательский интерфейс настраиваемой области задач. Атрибуты этого элемента управления предоставляют его модели COM.</p></td></tr></table></div></div><h3 class="subHeading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Компоненты ленты</h3><div class="subsection"><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">В следующей таблице приводится описание файлов проекта, которые предоставляют код для настройки ленты:</p><div class="caption"></div><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><tr><th><p>Файл</p></th><th><p>Описание</p></th></tr><tr><td><p>RibbonConnector.cs/vb</p></td><td><p>Определяет класс <span class="code">RibbonConnector</span>. Этот класс реализует интерфейс <b> Microsoft.Office.Core.IRibbonExtensibility</b>.</p></td></tr><tr><td><p>SimpleRibbon.xml</p><p>TaskRibbon.xml</p></td><td><p>Содержит XML-строки ленты, возвращаемые методом <b>GetCustomUI</b> реализации интерфейса <b>Microsoft.Office.Core.IRibbonExtensibility</b>.</p></td></tr></table></div></div><h3 class="subHeading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Компоненты области формы</h3><div class="subsection"><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">В следующей таблице приводится описание файлов проекта, которые предоставляют код для настраиваемой области формы, отображаемой в инспекторах задач:</p><div class="caption"></div><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><tr><th><p>Файл</p></th><th><p>Описание</p></th></tr><tr><td><p>FormRegionConnector.cs/vb</p></td><td><p>Определяет класс <span class="code">FormRegionConnector</span>. Этот класс реализует интерфейс <b>Microsoft.Office.Interop.Outlook.FormRegionStartup</b>.</p></td></tr><tr><td><p>FormRegionControls.cs/vb</p></td><td><p>Определяет класс, который управляет элементами управления в каждом экземпляре области формы.</p></td></tr><tr><td><p>PictureConverter.cs/vb</p></td><td><p>Преобразует изображение в объект <b>IPictureDisp</b>, который можно использовать для отображения значка в области формы.</p></td></tr><tr><td><p>SimpleFormRegion.ofs</p></td><td><p>Определяет пользовательский интерфейс области формы.</p></td></tr><tr><td><p>SimpleFormRegion.xml</p></td><td><p>Содержит манифест для области формы.</p></td></tr><tr><td><p>SimpleFormRegion.reg</p></td><td><p>Создает записи реестра, требуемые для загрузки области формы. </p></td></tr></table></div></div></div></div>
    </div>
</body></html>
