<html><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" /><META NAME="save" CONTENT="history" /><title xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Пример анализа данных</title><META NAME="Description" CONTENT="Данный пример работает только в Microsoft Office Excel 2007. "></META><META NAME="MS.LOCALE" CONTENT="en-us" /><style>
body
{font-family:Verdana;font-size:medium;}
div#mainSection, div#header
{font-size:70%;width: 100%;}
div#mainBody
{font-size:90%;}
div#mainSection div table
{font-size: 100%;text-align: left;}
span#nsrTitle
{color:#003399;font-size:90%;font-weight:600;}
div#header
{background-color:#D4DFFF;}
.heading
{font-size:120%;color:#003399;}
.subHeading
{font-size:100%;margin-bottom:4;}
li
{margin-top:-2;margin-bottom:3;}
p
{margin-top:10;margin-bottom:5;}
div.tableSection p
{margin-top:1;margin-bottom:4;}	
div#mainSection table th
{background-color:#EFEFF7;color:#000066;text-align:left;}
div#mainSection table td
{background-color:#F7F7FF;}
div#mainSection table
{margin-top:5px;margin-bottom: px;}
.style1{color: Green;}
			</style></head><body><div id="header"><table width="100%" id="topTable"></table></div><div id="mainSection"><div id="mainBody"><p><span class="style1">&#39; © Корпорация Майкрософт (Microsoft Corp.). Все права защищены. </span> <br class="style1" /> <span class="style1">&#39; Данный код выпущен на условиях </span> <br class="style1" /> <span class="style1">&#39; открытой лицензии Майкрософт (MS-PL, <a href="http://opensource.org/licenses/ms-pl.html"> http://opensource.org/licenses/ms-pl.html</a>.)</span></p><br /><br /><div class="introduction"><div class="alert"><table width="100%" cellspacing="0" cellpadding="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><tr><th align="left"><b>Примечание.</b></th></tr><tr><td><p>Данный пример работает только в Microsoft Office Excel 2007 и последующих версиях. </p></td></tr></table></div><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Он демонстрирует применение кнопок панелей инструментов и команд меню Excel 2007 для решения задач анализа данных. Данные хранятся в XML-файлах.</p><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Пример полностью локализуем; в нем показано, как использовать возможности класса System.Resources..::.ResourceManager и файлов управляемых ресурсов (RESX). При написании кода была предусмотрена возможность его глобализации с использованием приемов переключения языков и региональных параметров, которые требовались в ранних версиях набора средств Visual Studio Tools для Office. Теперь, после внесения изменений в принципы взаимодействия набора средств Visual Studio Tools для Office с Excel, такие приемы больше не нужны. Дополнительные сведения см. в разделах «Глобализация и локализация решений Office», «Форматирование данных в Excel при помощи различных региональных параметров» и «Инструкции: создание в Excel литералов, не зависящих от регионов, с помощью отражения». </p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><tr><th align="left"><b>Примечание.</b></th></tr><tr><td><p>Этот пример несовместим с английской версией Office, работающей под управлением Windows с настройкой региона, отличной от «Английский (США)».</p></td></tr></table></div><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Этот прием реализует простое средство управления товарными запасами на гипотетическом складе мороженого. Книга имеет системы для отслеживания объема продаж, товарных запасов и цен заказанной и реализованной продукции. Каждая из этих систем хранит данные в XML-файле.</p><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Склад налагает следующие ограничения на товары:</p><ul xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><li><p>Объем хранилища ограничен 300 единицами мороженого.</p></li><li><p>Заказы на мороженое доставляются утром, один раз в неделю.</p></li><li><p>Заказы должны быть размещены как минимум за два дня до планируемой даты поставки. Например, поставка товара на склад по заказу, размещенному во вторник, будет в четверг.</p></li><li><p>За незапланированную поставку взимается дополнительная плата в размере 25 единиц стоимости.</p></li></ul><div class="alert"><table width="100%" cellspacing="0" cellpadding="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><tr><th align="left"><b>Примечание по безопасности.</b></th></tr><tr><td><p>Этот пример кода приведен для иллюстрации концепции, в нем приведен код, который относится только к данной концепции. Пример может не отвечать требованиям безопасности для определенной среды, и его не следует использовать в точности в том виде, в котором он приведен. Чтобы сделать проект более безопасным и надежным, рекомендуется добавить в него код обеспечения безопасности и код обработки ошибок. Корпорация Майкрософт предоставляет этот пример кода на условиях «КАК ЕСТЬ», без каких-либо гарантий.</p></td></tr></table></div><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Сведения об установке проекта примера на компьютере см. в разделе «Инструкции: установка и использование файлов примеров, включенных в справку».</p></div><h3 class="procedureSubHeading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Запуск примера</h3><div class="subSection"><ol xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><li><p>Нажмите клавишу F5.</p><p>Книга открывается на листе Inventory (Запасы), на котором отображается сводная таблица по средним продажам за день и среднесуточной прибыли по каждому сорту мороженого, а также элемент управления ListObject, который показывает данные по продажам за предыдущий день. Обратите внимание, что группа с именем <span class="ui">Menu Commands</span> (Команды меню) и группа <span class="ui">Custom Toolbars</span> (Пользовательские панели инструментов) были добавлены на вкладку <span class="ui">Надстройки</span> ленты. Меню <span class="ui">Orders</span> (Заказы) было добавлено к группе <span class="ui">Menu Commands</span> (Команды меню). Две кнопки, соответствующие двум элементам меню, были добавлены к группе <span class="ui">Custom Toolbars</span> (Пользовательские панели инструментов).</p></li><li><p>Просмотрите историю продаж, выбрав другую дату в элементе управления «Календарь». Если выбирается последний день в данных, предоставляемых источником данных, то отображаются два дополнительных столбца — <span class="ui">Estimated Inventory</span> (Оценочные запасы) <span class="ui">Recommendation</span> (Рекомендации).</p></li><li><p>Выберите команду <span class="ui">Add New Date</span> (Добавить новую дату), чтобы добавить данные за новый день.</p><p>Содержимое элемента управления ListObject очищается, позволяя ввести объем складских запасов на конец дня по каждому сорту мороженого. После ввода объема текущих складских запасов по каждому сорту мороженого в столбце <span class="ui">Estimated Inventory</span> (Оценочные запасы) отображается ожидаемая на конец недели величина дефицита или избытка товара. В столбце <span class="ui">Recommendation</span> (Рекомендации) отображаются сведения о необходимости незапланированного заказа. В области действий отображаются списки товаров с недостаточным и избыточным объемом запасов.</p></li><li><p>Выберите команду <span class="ui">Save Data</span> (Сохранить данные), чтобы сохранить внесенные изменения.</p></li><li><p>В одном из списков в области действий выберите сорт мороженого.</p><p>На листе Details (Подробности) будут отображены исторические данные по продажам и график.</p></li><li><p>Если рекомендуется сделать незапланированный заказ, выберите команду <span class="ui">Create</span> (Создать), чтобы определить, какие сорта мороженого, и какой объем следует включить в заказ.</p></li><li><p>В книгу будет добавлен новый лист с именем <span class="ui">Unscheduled Order_</span><span class="placeholder">&lt;дата&gt;</span> (Незапланированный заказ_дата). На листе по каждому сорту мороженого приводится оценка количества, которое следует включить в заказ, чтобы покрыть до конца недели возможный дефицит складских запасов этого сорта.</p></li><li><p>Чтобы создать заказ на неделю, выберите пункт <span class="ui">Create Weekly Order</span> (Создать недельный заказ) в меню <span class="ui">Orders</span> (Заказы).</p><p>Из XML-файлов считывается информация о продажах за предыдущие две недели, вычисляется средний объем продаж за день и определяется среднеквадратичное отклонение распределения. Оценка объема будущих продаж вычисляется следующим образом: сумма среднего объема продаж за день и удвоенного значения среднеквадратического отклонения умножается на семь дней. Это объем товара, который будет продан за неделю с вероятностью 95,4%.</p><p>В книгу будет добавлен новый лист с именем <span class="ui">Weekly Order_</span><span class="placeholder">&lt;дата&gt;</span> (Недельный заказ_дата). Здесь <span class="placeholder">&lt;дата&gt;</span> — это предполагаемая дата заказа.</p></li></ol></div><h1 class="heading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><span onclick="ExpandCollapse(demonstratesToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(demonstratesToggle, event)" tabindex="0">Демонстрации</span></h1><div id="demonstratesSection" class="section"><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">В этом образце демонстрируются следующие задачи:</p><ul xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><li><p>Чтение данных из XML-файлов.</p></li><li><p>Настройка меню и панелей инструментов.</p></li><li><p>Использование встроенных функций Excel для анализа данных.</p></li><li><p>Создание сводных таблиц, связанных с данными в XML-файлах.</p></li><li><p>Привязка XML-данных к элементам управления «Список» Excel.</p></li><li><p>Построение диаграмм.</p></li><li><p>Подготовка для локализации строк и структуры пользовательского интерфейса.</p></li></ul></div></div>
    </div>
</body></html>
