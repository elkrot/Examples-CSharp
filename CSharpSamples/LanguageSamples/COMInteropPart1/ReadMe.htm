<!--ДЛЯ ЧТЕНИЯ ЭТОГО ФАЙЛА СПРАВКИ ЩЕЛКНИТЕ ПРАВОЙ КНОПКОЙ МЫШИ ИМЯ ФАЙЛА В 
    ОБОЗРЕВАТЕЛЕ РЕШЕНИЙ И ВЫБЕРИТЕ КОМАНДУ "ПРОСМОТР В ОБОЗРЕВАТЕЛЕ"-->

<html><head><title>Образец COM-взаимодействия, часть 1</title></head><body><h1>Образец COM-взаимодействия, часть 1</h1><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p /><p>Данный образец демонстрирует способ взаимодействия программы на языке C# с неуправляемым COM-компонентом.</p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Примечание по безопасности </th></tr><tr><td><p>Данный образец кода предоставлен для иллюстрирования концепции и не должен использоваться в приложениях или веб-сайтах, так как он не демонстрирует опыт написания безопасного кода. Корпорация Майкрософт не несет ответственность за случайный или косвенный ущерб, который может быть вызван использованием кода примера не по назначению.</p>
Примечание. Если параметр nopia включен, создать новый компонентный класс COM нельзя.</p></td></tr></table></div><h1 class="heading">Построение и запуск образцов COM-взаимодействия (часть 1) в Visual Studio</h1><div id="procedureSection1" class="section"><ol><li><p>В <b>обозревателе решений</b> щелкните правой кнопкой мыши проект Interop1 и выберите пункт <b>Назначить запускаемым проектом</b>.</p></li><li><p>В <b>обозревателе решений</b> щелкните правой кнопкой мыши проект Interop1 и выберите пункт <b>Свойства</b>.</p></li><li><p>Откройте папку «Свойства конфигурации» и выберите пункт <b>Отладка</b>.</p></li><li><p>В поле свойства «Аргументы командной строки» введите AVI-файл, например <code>c:\winnt\clock.avi</code>.</p></li><li><p>Нажмите кнопку <b>ОК</b>.</p></li><li><p>В меню <b>Отладка</b> выберите команду <b>Запуск без отладки</b>.</p></li><li><p>Повторите предыдущие шаги для Interop2.</p></li></ol></div><h1 class="heading">Если библиотека QuartzTypeLib.dll, включенная в Interop1, устарела</h1><div id="procedureSection2" class="section"><ol><li><p>В <b>обозревателе решений</b> откройте пункт <b>Ссылки</b> для Interop1.</p></li><li><p>Щелкните правой кнопкой мыши пункт <b>QuartzTypeLib</b>, а затем выберите команду <b>Удалить</b>.</p></li><li><p>Щелкните правой кнопкой мыши пункт <b>Ссылки</b> и выберите команду <b>Добавить ссылку</b>.</p></li><li><p>На вкладке <b>COM</b> выберите компонент с именем «Библиотека типов элементов управления ActiveMovie».</p></li><li><p>Нажмите кнопку <b>Выбрать</b>, а затем кнопку <b>OK</b>.</p></li><li><p>Выполните повторное построение Interop1.</p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Примечание </th></tr><tr><td><p>Добавление ссылки на компонент аналогично вызову tlbimp в командной строке с целью создания библиотеки QuartzTypeLib.dll (как показано ниже).</p></td></tr></table></div></li><li><p></p></li></ol></div><h1 class="heading">Построение и запуск образцов COM-взаимодействия (часть 1) из командной строки</h1><div id="procedureSection3" class="section"><ol><li><p>Для перехода к каталогу Interop1 используйте команду <b>Сменить каталог</b>.</p></li><li><p>Введите следующие данные: </p><div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><td colspan="2"><pre>tlbimp %windir%\system32\quartz.dll /out:QuartzTypeLib.dll
csc /l:QuartzTypeLib.dll interop1.cs 
interop1 %windir%\clock.avi</pre></td></tr></table></span></div></li><li><p>Для перехода к каталогу Interop2 используйте команду <b>Сменить каталог</b>.</p></li><li><p>Введите следующие данные: </p><div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><td colspan="2"><pre>csc interop2.cs
interop2 %windir%\clock.avi</pre></td></tr></table></span></div></li></ol></div></div><div id="footer"><div class="footerLine">
</div>Примечание. Если параметр nopia включен, создать новый компонентный класс COM нельзя.</div>
</div>Для отправки предложений или отчета об ошибке по справке или другой функции данного продукта перейдите на <a href="http://go.microsoft.com/fwlink/?LinkId=50040">веб-сайт отзывов</a>.
      </div></div></body></html>

