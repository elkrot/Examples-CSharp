<!-- ЧТОБЫ ПРОЧИТАТЬ ЭТОТ ФАЙЛ СПРАВКИ, ЩЕЛКНИТЕ ИМЯ ФАЙЛА В ОБЛАСТИ 
     ОБОЗРЕВАТЕЛЯ РЕШЕНИЙ ПРАВОЙ КНОПКОЙ МЫШИ И ВЫБЕРИТЕ "ПРОСМОТР В 
     ОБОЗРЕВАТЕЛЕ". -->

<html><head><title>Пример COM-взаимодействия, часть 2</title></head><body><h1>Пример COM-взаимодействия, часть 2</h1><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p /><p>Данный пример демонстрирует использование сервера C# с клиентом C++ COM.</p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Примечание </th></tr><tr><td><p>
	Для выполнения данной программы требуются права администратора, а для компилирования данного примера требуется установленный Visual C++.</p></td></tr></table></div><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Примечание по безопасности </th></tr><tr><td><p>Данный код примера предоставлен для иллюстрирования концепции и не должен использоваться в приложениях или веб-узлах, так как он не демонстрирует опыт написания безопасного кода. Microsoft не несет ответственность за случайные или косвенные повреждения, вызванные применением кода примера не по назначению.</p></td></tr></table></div><h1 class="heading">Построение и выполнение примера COM-взаимодействия, часть 2 в Visual Studio.</h1><div id="procedureSection1" class="section"><ol><li><p>В <b>Обозревателе решений</b> щелкните правой кнопкой проект COMClient и выберите <b>Свойства</b>.</p></li><li><p>Откройте папку Свойства конфигурации и щелкните <b>Отладка</b>.</p></li><li><p>Для свойства Аргументы командной строки введите имя.</p></li><li><p>Нажмите кнопку <b>ОК</b>.</p></li><li><p>В меню <b>Отладка</b> щелкните <b>Запуск без отладки</b>.</p></li></ol></div><h1 class="heading">Построение и выполнение примера COM-взаимодействия, часть 2 из командной строки.</h1><div id="procedureSection2" class="section"><ol><li><p>С помощью команды <b>Изменить каталог</b> для перехода в каталог COMInteropPart2\COMClient.</p></li><li><p>Скопируйте код сервера C# в каталог COMClient. </p><div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><td colspan="2"><pre>copy ..\CSharpServer\CSharpServer.cs</pre></td></tr></table></span></div></li><li><p>Скомпилируйте сервер: </p><div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><td colspan="2"><pre>csc /target:library CSharpServer.cs
regasm CSharpServer.dll /tlb:CSharpServer.tlb</pre></td></tr></table></span></div></li><li><p>Скомпилируйте клиент (убедитесь, что переменные для пути и среды верно заданы с помощью vcvars32.bat): </p><div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><td colspan="2"><pre>cl COMClient.cpp</pre></td></tr></table></span></div></li><li><p>Запустите клиент: </p><div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><td colspan="2"><pre>Дружественный COMClient</pre></td></tr></table></span></div></li></ol></div></div><div id="footer"><div class="footerLine"></div>
        Для отправки предложений или отчета об ошибке по Справке или другой функции данного продукта перейдите на <a href="http://go.microsoft.com/fwlink/?LinkId=50040">веб-узел отзывов</a>.
      </div></div></body></html>

