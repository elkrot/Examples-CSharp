<html xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office">

<head>
</head>

<body>
<!-- When viewing in Visual Studio, choose the Design button for easier reading. -->
<p>Визуализатор запроса – это сборка, которая может использоваться в сеансе отладки Visual Studio для визуализации запросов базы данных. Сам проект представляет собой библиотеку и не может быть выполнен. При его компилировании генерируется библиотека (DLL), которая может использоваться в Visual Studio для отладки приложений LINQ to SQL.</p>

<p class="MsoNormal"><strong>ПРИМЕЧАНИЕ</strong>. При отладке приложения с использованием визуализатора может потребоваться добавление &quot;<span style="color: #A31515">Persist Security Info=true&quot; </span> к строке подключения. Когда отладчик активирован, он выполняет функцию сериализатора информации из программы, отладка которой выполняется, и отправляет информацию процессу, отображающему визуализатор.&nbsp; Часть информации, которая сериализуется, представляет строку подключения, которая определяется из объекта SqlConnection. По умолчанию объект SqlConnection не возвращает пароль, таким образом, сериализуется строка подключения без пароля, которая потом отправляется визуализатору.&nbsp; При попытке выполнения запроса в визуализаторе может произойти сбой по причине отсутствия пароля.&nbsp; </span> Используйте данную настройку при отладке. Не рекомендуется использование данной настройки в производстве.&nbsp;</p>
<p>Для использования визуализатора библиотека DLL, сгенерированная проектом <strong>LinqToSqlQueryVisualizer</strong> должна быть скопирована в каталог <strong>...\Documents\Visual Studio 2008\Visualizers </strong>. Может потребоваться создание каталога <strong>Visualizers</strong>. В версиях Windows, предшествующих версиям Vista, используйте каталог <strong>Мои документы</strong> вместо каталога <strong>Документы</strong>. При наличии соответствующих прав можно также скопировать файл в каталог:

 <strong>...\Program Files\Microsoft Visual Studio 9.0\Common7\Packages\Debugger\Visualizers.</strong></p>

<p>Далее представлена пошаговая инструкция.</p>
<ul>
	<li>Выполните построение Визуализатора запроса.</li>
	<li>Скопируйте библиотеку DLL, произведенную при компилировании, из каталога исполнительных модулей проекта в каталог <strong>Visualizers</strong>.</li>
	<li>При необходимости закройте Visual Studio и повторно откройте для определения визуализатора.</li>
	<li>Визуализатор можно проверить в существующем примере проекта, например, <strong>SampleQueries</strong></li>
	<li>Кроме того, для проверки визуализатора можно создать консольное приложение по умолчанию.</li>
	<li>Для начала создания собственного окружения теста создайте консольное приложение по умолчанию.</li>
	<li>Используйте конструктор LINQ to SQL для вложения в базу данных «Борей», поставляемой с примерами.<ul>
		<li>Вызовите диалоговое окно <strong>Добавить новый элемент</strong> (Ctrl-Shift-A)</li>
		<li>Выберите <strong>Классы LINQ to SQL</strong></li>
		<li>Вызовите <strong>Обозреватель серверов</strong> (Ctrl-W, L)</li>
		<li>Нажмите кнопку <strong>Подключиться к базе данных</strong> в обозревателе. При необходимости выберите файл базы данных Microsoft SQL Server в качестве источника данных. Найдите базу данных <strong>Northwind.mdb</strong> в каталоге <strong>Data</strong>, поставляемую с примерами.</li>
		<li>Перетащите таблицу <strong>Клиенты</strong> на конструктор.</li>
	</ul>
	</li>
	<li>Запишите и вызовите простой запрос, например, представленный далее запрос с названием <strong> SimpleQuery()</strong>:</li>
	<li>Установите точку останова в линии <strong>foreach</strong> и осуществите выполнение до нее.</li>
	<li>Поместите курсор мыши над словом <strong>query</strong> и откройте визуализатор, нажав на увеличительную лупу: <img alt="Увеличить" src="Magnify.png" width="33" height="16"><br>
	</li>
</ul>
<pre>        public void SimpleQuery()
        {
            DataClasses1DataContext db = new DataClasses1DataContext();

            var query = from c in db.Customers
                        select c;

            foreach (var item in query)
            {
                Console.WriteLine(item.CompanyName);
            }
        }
</pre>

</body>
</html>

