' © Корпорация Майкрософт (Microsoft Corp.).  Все права защищены.
' Этот код выпущен на условиях открытой 
' лицензии Майкрософт (MS-PL, http://opensource.org/licenses/ms-pl.html.)

*************Файл сведений****************

Эти сведения относятся к образцам проектов VB и C#.

В этих образцах BDC производится подключение к базе данных «Борей» как внешнему 
источнику данных. Перед запуском образца проекта внимательно прочитайте 
следующие заметки и убедитесь в наличии подключения к базе данных «Борей».


******************************
Подготовка базы данных «Борей»
******************************

Если база данных «Борей» уже имеется, достаточно открыть файл Setting.setting в 
каждом проекте и заменить значение NORTHWNDConnectionString своей строкой 
подключения.

В противном случае выполните следующие действия:

1. При выполнении следующих шагов предполагается, что на компьютере уже 
   установлено приложение SQL Express, бесплатно включаемое в комплекты решений 
   Visual Studio и SharePoint Server. Если оно не установлено, предварительно 
   посетите веб-сайт http://www.microsoft.com/express/sql/download/ и 
   установите SQL Express.

2. Создайте базу данных SampleNorthwind. Для этого откройте VS. Выберите 
   команду «Вид -> Обозреватель серверов». Щелкните правой кнопкой мыши узел 
   «Подключения данных» в окне «Обозреватель серверов» и выберите команду 
   «Создание новой базы данных SQL Server».

3. В окне приглашения введите «localhost\sqlexpress» в качестве имени сервера и 
   присвойте базе данных имя «SampleNorthwind».

   * Если используется SQL Express из комплекта поставки SharePoint Server, 
     вместо «localhost\sqlexpress» укажите «localhost\sharepoint».

4. Откройте окно командной строки.

5. В командной строке введите следующую команду, после чего нажмите клавишу 
   ВВОД: 

	sqlcmd -S localhost\sqlexpress -d samplenorthwind -i <Путь файла 
           CreateSampleNorthwindDB.sql>
   
   * Файл CreateSampleNorthwindDB.sql находится в той же папке, что и данный 
     файл сведений. Он используется для автоматического создания схемы и данных 
     таблицы клиентов.


************************************************
Развертывание модели подключения к бизнес-данным
************************************************

Теперь можно открыть примеры проектов. Сначала потребуется указать URL-адрес 
сайта проекта. Для этого щелкните узел проекта в окне «Свойства» и задайте для 
URL-адреса сайта значение «http://localhost». Нажмите клавишу F5 для отладки 
или выберите команду Построение->Развернуть, чтобы развернуть модель 
подключения к бизнес-данным.

* Следует иметь в виду, что если вы собираетесь работать с обоими примерами 
  проектов, для подключения второго проекта рекомендуется создать вторую 
  таблицу базы данных.

Сейчас оба примера проекта подключены к одной, только что созданной, базе 
данных, поэтому может оказаться, что во время выполнения только один проект 
будет правильно подключен к базе данных. Во избежание конфликтов данных 
настоятельно рекомендуется создать вторую таблицу. Для этого достаточно 
повторно выполнить описанную выше процедуру, лишь указав другое имя таблицы. 
После этого откройте файл Setting.setting в проекте и измените значение 
NORTHWNDConnectionString для подключения к новой таблице.


********************************************
Создание внешнего списка на сайте SharePoint
********************************************

После того как модель подключения к бизнес-данным успешно развернута, можно 
создать на сайте SharePoint внешний список для работы с данными. 

Для этого выполните следующие действия: 

1. Перейдите на домашнюю страницу сайта SharePoint. Обычно она имеет адрес 
   Http://localhost.
2. В левом верхнем углу страницы узла выберите «Действия сайта -> 
   «Дополнительные параметры». 
3. На странице «Создание» выберите пункт «Внешний список».
4. На странице «Создание» введите имя для списка. В разделе «Конфигурация 
   источника данных» нажмите кнопку «Выбрать внешний тип контента». В окне 
   выбора внешнего типа контента выберите только что развернутый тип — 
   BdcSampleCSharp.BdcModel1.Customer или BdcSampleVB.Customer.

   *Примечание. Если какие-либо типы не отображаются в окне выбора внешних 
    типов контента, возможно, у вас нет разрешения на доступ в хранилище 
    метаданных BDC. Для получения разрешения, откройте центр администрирования 
    SharePoint, перейдите на страницу «Управление приложениями-службами» и 
    щелкните службу подключения к бизнес-данным. На странице «Просмотр внешних 
    типов контента» нажмите кнопку «Задать разрешения хранилища метаданных». 
    Затем в диалоговом окне «Задание разрешений хранилища метаданных» добавьте 
    свою учетную запись пользователя и предоставьте разрешения.

5. Нажмите кнопку «ОК» на странице «Создание».

Теперь можно будет выводить список клиентов на странице SharePoint и создавать, 
обновлять или удалять сведения о клиентах. Эти изменения будут отражаться в 
базе данных в режиме реального времени.
